{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Nazmul/OneDrive/Documents/trust-market/frontend/utils/chatStorage.js"],"sourcesContent":["// utils/chatStorage.js\r\nexport const loadChat = () => {\r\n  const data = localStorage.getItem(\"chat_data\");\r\n  return data ? JSON.parse(data) : { messages: [] };\r\n};\r\n\r\n// senderType: \"buyer\" বা \"admin\"\r\n// text: message text\r\n// attachments: array\r\n// buyerId: unique buyer id\r\nexport const addMessage = (senderType, text, attachments = [], buyerId) => {\r\n  const data = loadChat();\r\n  const newMsg = {\r\n    id: Date.now() + \"_\" + Math.random(),\r\n    from: senderType,\r\n    text,\r\n    attachments,\r\n    buyerId,\r\n    time: new Date().toLocaleTimeString([], { hour: \"2-digit\", minute: \"2-digit\" })\r\n  };\r\n  data.messages.push(newMsg);\r\n  localStorage.setItem(\"chat_data\", JSON.stringify(data));\r\n};\r\n"],"names":[],"mappings":"AAAA,uBAAuB;;;;;;;AAChB,MAAM,WAAW;IACtB,MAAM,OAAO,aAAa,OAAO,CAAC;IAClC,OAAO,OAAO,KAAK,KAAK,CAAC,QAAQ;QAAE,UAAU,EAAE;IAAC;AAClD;AAMO,MAAM,aAAa,CAAC,YAAY,MAAM,cAAc,EAAE,EAAE;IAC7D,MAAM,OAAO;IACb,MAAM,SAAS;QACb,IAAI,KAAK,GAAG,KAAK,MAAM,KAAK,MAAM;QAClC,MAAM;QACN;QACA;QACA;QACA,MAAM,IAAI,OAAO,kBAAkB,CAAC,EAAE,EAAE;YAAE,MAAM;YAAW,QAAQ;QAAU;IAC/E;IACA,KAAK,QAAQ,CAAC,IAAI,CAAC;IACnB,aAAa,OAAO,CAAC,aAAa,KAAK,SAAS,CAAC;AACnD","debugId":null}},
    {"offset": {"line": 37, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Nazmul/OneDrive/Documents/trust-market/frontend/pages/messages/index.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\r\nimport { addMessage, loadChat } from \"../../utils/chatStorage\";\r\nimport { Paperclip, Send } from \"lucide-react\";\r\n\r\nexport default function BuyerChatPage({ buyerId }) {\r\n  const [messages, setMessages] = useState([]);\r\n  const [text, setText] = useState(\"\");\r\n  const [attachments, setAttachments] = useState([]);\r\n  const fileInputRef = useRef(null);\r\n  const messagesEndRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      const data = loadChat();\r\n      setMessages(data.messages.filter(m => m.buyerId === buyerId));\r\n      messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n    }, 500);\r\n    return () => clearInterval(interval);\r\n  }, [buyerId]);\r\n\r\n  const sendMessage = () => {\r\n    if (!text && attachments.length === 0) return;\r\n    addMessage(\"buyer\", text, attachments, buyerId);\r\n    setText(\"\");\r\n    setAttachments([]);\r\n  };\r\n\r\n  const handleFiles = (files) => {\r\n    const newAtts = Array.from(files).map(file => {\r\n      const type = file.type.startsWith(\"image/\") ? \"image\" :\r\n                   file.type.startsWith(\"video/\") ? \"video\" : \"file\";\r\n      const preview = type === \"file\" ? null : URL.createObjectURL(file);\r\n      return { id: Date.now() + Math.random(), file, type, preview };\r\n    });\r\n    setAttachments(prev => [...prev, ...newAtts]);\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 p-4 max-w-xl mx-auto\">\r\n      <h1 className=\"text-xl font-bold mb-4\">Buyer Chat ({buyerId})</h1>\r\n\r\n      <div className=\"bg-white p-3 rounded-md shadow-md flex flex-col gap-2 max-h-[60vh] overflow-auto\">\r\n        {messages.length === 0 && <p className=\"text-gray-400 text-center\">No messages yet</p>}\r\n        {messages.map(m => (\r\n          <div key={m.id} className={`p-2 rounded-md ${m.from===\"buyer\"?\"bg-blue-600 text-white self-end\":\"bg-gray-200 self-start\"}`}>\r\n            {m.text && <div>{m.text}</div>}\r\n            {m.attachments?.map(a => (\r\n              a.type===\"image\"?<img key={a.id} src={a.preview} className=\"w-24 h-24 object-cover mt-1\"/>:\r\n              a.type===\"video\"?<video key={a.id} src={a.preview} className=\"w-24 h-24 mt-1\" controls/>:\r\n              <div key={a.id} className=\"bg-gray-100 p-1 rounded mt-1\">{a.file.name}</div>\r\n            ))}\r\n          </div>\r\n        ))}\r\n        <div ref={messagesEndRef}/>\r\n      </div>\r\n\r\n      <div className=\"mt-2 flex gap-2\">\r\n        <button onClick={()=>fileInputRef.current.click()} className=\"p-2 bg-gray-200 rounded-md\"><Paperclip/></button>\r\n        <input type=\"file\" ref={fileInputRef} className=\"hidden\" multiple onChange={e=>handleFiles(e.target.files)}/>\r\n        <textarea value={text} onChange={e=>setText(e.target.value)} className=\"flex-1 border rounded-md p-2 resize-none\" placeholder=\"Write a message...\"/>\r\n        <button onClick={sendMessage} className=\"bg-green-600 text-white p-2 rounded-md flex items-center gap-1\"><Send/> Send</button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}