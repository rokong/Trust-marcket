{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Nazmul/OneDrive/Documents/trust-market/frontend/pages/messages/index.js"],"sourcesContent":["// pages/messages/index.js - Frontend (Client Side)\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport io from 'socket.io-client';\r\n\r\n// মনে রাখবেন, আপনার Next.js সার্ভার এবং Socket.IO সার্ভার একই URL এ না চললে,\r\n// আপনাকে এখানে সঠিক URL দিতে হবে।\r\nconst socket = io('http://localhost:3001'); // উদাহরণস্বরূপ পোর্ট 3001 ব্যবহার করা হয়েছে\r\n\r\n// আপনি ইউজার লগইন করার পর user ID এবং Name পাবেন\r\nconst USER_ID = 'user_unique_id_123'; \r\nconst USER_NAME = 'Example User';\r\n\r\nfunction UserChatWindow() {\r\n  const [message, setMessage] = useState('');\r\n  const [messages, setMessages] = useState([]);\r\n\r\n  useEffect(() => {\r\n    // 1. এডমিন প্যানেলকে জানান যে ইউজার কানেক্ট হয়েছে\r\n    socket.emit('user_connected', { userId: USER_ID, userName: USER_NAME });\r\n\r\n    // 2. নতুন মেসেজ গ্রহণ করুন\r\n    socket.on('receive_message', (msg) => {\r\n      setMessages((prevMessages) => [...prevMessages, msg]);\r\n    });\r\n\r\n    // 3. পেজ লোড হলে পুরনো মেসেজ লোড করার জন্য ব্যাকএন্ডে রিকোয়েস্ট পাঠান\r\n    // useEffect এর শুরুতে লোড মেসেজের API কল থাকতে পারে\r\n\r\n    // Cleanup function\r\n    return () => {\r\n      socket.off('receive_message');\r\n    };\r\n  }, []);\r\n\r\n  const sendMessage = (e) => {\r\n    e.preventDefault();\r\n    if (message.trim()) {\r\n      const msgData = {\r\n        chatId: USER_ID,   // ← NEW (প্রতি ইউজারের chatId হবে তার userId)\r\n        userId: USER_ID,\r\n        userName: USER_NAME,\r\n        text: message,\r\n        sender: 'user',\r\n        timestamp: new Date().toISOString(),\r\n      };\r\n\r\n      socket.emit('send_message', msgData);\r\n      setMessages(prev => [...prev, msgData]);\r\n      setMessage('');\r\n    }\r\n  };\r\n\r\n\r\n  return (\r\n    <div>\r\n      <h1>Chat with Admin</h1>\r\n      <div style={{ height: '300px', overflowY: 'scroll', border: '1px solid #ccc', padding: '10px' }}>\r\n        {messages.map((msg, index) => (\r\n          <p key={index} style={{ textAlign: msg.sender === 'user' ? 'right' : 'left' }}>\r\n            <strong>{msg.sender === 'user' ? 'You' : 'Admin'}:</strong> {msg.text}\r\n          </p>\r\n        ))}\r\n      </div>\r\n      <form onSubmit={sendMessage}>\r\n        <input\r\n          type=\"text\"\r\n          value={message}\r\n          onChange={(e) => setMessage(e.target.value)}\r\n          placeholder=\"Type your message...\"\r\n        />\r\n        <button type=\"submit\">Send</button>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default UserChatWindow;"],"names":[],"mappings":"AAAA,mDAAmD;;;;;;AAEnD;AACA;;;;;;;;AAEA,6EAA6E;AAC7E,kCAAkC;AAClC,MAAM,SAAS,IAAA,uJAAE,EAAC,0BAA0B,4CAA4C;AAExF,iDAAiD;AACjD,MAAM,UAAU;AAChB,MAAM,YAAY;AAElB,SAAS;IACP,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+GAAQ,EAAC;IACvC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,+GAAQ,EAAC,EAAE;IAE3C,IAAA,gHAAS,EAAC;QACR,mDAAmD;QACnD,OAAO,IAAI,CAAC,kBAAkB;YAAE,QAAQ;YAAS,UAAU;QAAU;QAErE,2BAA2B;QAC3B,OAAO,EAAE,CAAC,mBAAmB,CAAC;YAC5B,YAAY,CAAC,eAAiB;uBAAI;oBAAc;iBAAI;QACtD;QAEA,uEAAuE;QACvE,oDAAoD;QAEpD,mBAAmB;QACnB,OAAO;YACL,OAAO,GAAG,CAAC;QACb;IACF,GAAG,EAAE;IAEL,MAAM,cAAc,CAAC;QACnB,EAAE,cAAc;QAChB,IAAI,QAAQ,IAAI,IAAI;YAClB,MAAM,UAAU;gBACd,QAAQ;gBACR,QAAQ;gBACR,UAAU;gBACV,MAAM;gBACN,QAAQ;gBACR,WAAW,IAAI,OAAO,WAAW;YACnC;YAEA,OAAO,IAAI,CAAC,gBAAgB;YAC5B,YAAY,CAAA,OAAQ;uBAAI;oBAAM;iBAAQ;YACtC,WAAW;QACb;IACF;IAGA,qBACE,qKAAC;;0BACC,qKAAC;0BAAG;;;;;;0BACJ,qKAAC;gBAAI,OAAO;oBAAE,QAAQ;oBAAS,WAAW;oBAAU,QAAQ;oBAAkB,SAAS;gBAAO;0BAC3F,SAAS,GAAG,CAAC,CAAC,KAAK,sBAClB,qKAAC;wBAAc,OAAO;4BAAE,WAAW,IAAI,MAAM,KAAK,SAAS,UAAU;wBAAO;;0CAC1E,qKAAC;;oCAAQ,IAAI,MAAM,KAAK,SAAS,QAAQ;oCAAQ;;;;;;;4BAAU;4BAAE,IAAI,IAAI;;uBAD/D;;;;;;;;;;0BAKZ,qKAAC;gBAAK,UAAU;;kCACd,qKAAC;wBACC,MAAK;wBACL,OAAO;wBACP,UAAU,CAAC,IAAM,WAAW,EAAE,MAAM,CAAC,KAAK;wBAC1C,aAAY;;;;;;kCAEd,qKAAC;wBAAO,MAAK;kCAAS;;;;;;;;;;;;;;;;;;AAI9B;uCAEe","debugId":null}}]
}