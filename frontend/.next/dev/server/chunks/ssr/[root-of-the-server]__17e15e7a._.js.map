{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Nazmul/OneDrive/Documents/trust-market/frontend/pages/admin/messages.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\r\nimport { addMessage, loadChat } from \"../utils/chatStorage\";\r\nimport { Paperclip, Send } from \"lucide-react\";\r\n\r\nexport default function BuyerChatPage() {\r\n  const buyerId = \"buyer_123\"; // Each buyer should have unique ID\r\n  const [messages, setMessages] = useState([]);\r\n  const [text, setText] = useState(\"\");\r\n  const [attachments, setAttachments] = useState([]);\r\n  const fileInputRef = useRef(null);\r\n  const messagesEndRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      const data = loadChat();\r\n      setMessages(data.messages.filter(m => m.buyerId === buyerId));\r\n    }, 1000);\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  const sendMessage = () => {\r\n    if (!text && attachments.length === 0) return;\r\n\r\n    addMessage(\"buyer\", text, attachments, buyerId);\r\n    setText(\"\");\r\n    setAttachments([]);\r\n  };\r\n\r\n  const handleFiles = (files) => {\r\n    const newAtts = Array.from(files).map(file => {\r\n      const type = file.type.startsWith(\"image/\") ? \"image\" :\r\n                   file.type.startsWith(\"video/\") ? \"video\" : \"file\";\r\n      const preview = type === \"file\" ? null : URL.createObjectURL(file);\r\n      return { id: Date.now() + Math.random(), file, type, preview };\r\n    });\r\n    setAttachments(prev => [...prev, ...newAtts]);\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 p-4 max-w-xl mx-auto\">\r\n      <h1 className=\"text-xl font-bold mb-4\">Buyer Chat</h1>\r\n\r\n      <div className=\"bg-white p-3 rounded-md shadow-md flex flex-col gap-2 max-h-[60vh] overflow-auto\">\r\n        {messages.length === 0 && <p className=\"text-gray-400 text-center\">No messages yet</p>}\r\n        {messages.map(m => (\r\n          <div key={m.id} className={`p-2 rounded-md ${m.from===\"buyer\"?\"bg-blue-600 text-white self-end\":\"bg-gray-200 self-start\"}`}>\r\n            {m.text && <div>{m.text}</div>}\r\n            {m.attachments?.map(a => (\r\n              a.type===\"image\" ? <img key={a.id} src={a.preview} className=\"w-24 h-24 object-cover mt-1\"/> :\r\n              a.type===\"video\" ? <video key={a.id} src={a.preview} className=\"w-24 h-24 mt-1\" controls/> :\r\n              <div key={a.id} className=\"bg-gray-100 p-1 rounded mt-1\">{a.file.name}</div>\r\n            ))}\r\n          </div>\r\n        ))}\r\n        <div ref={messagesEndRef}/>\r\n      </div>\r\n\r\n      <div className=\"mt-2 flex gap-2\">\r\n        <button onClick={() => fileInputRef.current.click()} className=\"p-2 bg-gray-200 rounded-md\">\r\n          <Paperclip/>\r\n        </button>\r\n        <input type=\"file\" ref={fileInputRef} className=\"hidden\" multiple onChange={e => handleFiles(e.target.files)}/>\r\n        <textarea \r\n          value={text} \r\n          onChange={e => setText(e.target.value)} \r\n          className=\"flex-1 border rounded-md p-2 resize-none\" \r\n          placeholder=\"Write a message...\"\r\n        />\r\n        <button onClick={sendMessage} className=\"bg-green-600 text-white p-2 rounded-md flex items-center gap-1\">\r\n          <Send/> Send\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;;;;;;AAEA;AAAA;;;;;AAEe,SAAS;IACtB,MAAM,UAAU,aAAa,mCAAmC;IAChE,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,+GAAQ,EAAC,EAAE;IAC3C,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,+GAAQ,EAAC;IACjC,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,+GAAQ,EAAC,EAAE;IACjD,MAAM,eAAe,IAAA,6GAAM,EAAC;IAC5B,MAAM,iBAAiB,IAAA,6GAAM,EAAC;IAE9B,IAAA,gHAAS,EAAC;QACR,MAAM,WAAW,YAAY;YAC3B,MAAM,OAAO;YACb,YAAY,KAAK,QAAQ,CAAC,MAAM,CAAC,CAAA,IAAK,EAAE,OAAO,KAAK;QACtD,GAAG;QACH,OAAO,IAAM,cAAc;IAC7B,GAAG,EAAE;IAEL,MAAM,cAAc;QAClB,IAAI,CAAC,QAAQ,YAAY,MAAM,KAAK,GAAG;QAEvC,WAAW,SAAS,MAAM,aAAa;QACvC,QAAQ;QACR,eAAe,EAAE;IACnB;IAEA,MAAM,cAAc,CAAC;QACnB,MAAM,UAAU,MAAM,IAAI,CAAC,OAAO,GAAG,CAAC,CAAA;YACpC,MAAM,OAAO,KAAK,IAAI,CAAC,UAAU,CAAC,YAAY,UACjC,KAAK,IAAI,CAAC,UAAU,CAAC,YAAY,UAAU;YACxD,MAAM,UAAU,SAAS,SAAS,OAAO,IAAI,eAAe,CAAC;YAC7D,OAAO;gBAAE,IAAI,KAAK,GAAG,KAAK,KAAK,MAAM;gBAAI;gBAAM;gBAAM;YAAQ;QAC/D;QACA,eAAe,CAAA,OAAQ;mBAAI;mBAAS;aAAQ;IAC9C;IAEA,qBACE,qKAAC;QAAI,WAAU;;0BACb,qKAAC;gBAAG,WAAU;0BAAyB;;;;;;0BAEvC,qKAAC;gBAAI,WAAU;;oBACZ,SAAS,MAAM,KAAK,mBAAK,qKAAC;wBAAE,WAAU;kCAA4B;;;;;;oBAClE,SAAS,GAAG,CAAC,CAAA,kBACZ,qKAAC;4BAAe,WAAW,CAAC,eAAe,EAAE,EAAE,IAAI,KAAG,UAAQ,oCAAkC,0BAA0B;;gCACvH,EAAE,IAAI,kBAAI,qKAAC;8CAAK,EAAE,IAAI;;;;;;gCACtB,EAAE,WAAW,EAAE,IAAI,CAAA,IAClB,EAAE,IAAI,KAAG,wBAAU,qKAAC;wCAAe,KAAK,EAAE,OAAO;wCAAE,WAAU;uCAAhC,EAAE,EAAE;;;;+CACjC,EAAE,IAAI,KAAG,wBAAU,qKAAC;wCAAiB,KAAK,EAAE,OAAO;wCAAE,WAAU;wCAAiB,QAAQ;uCAAzD,EAAE,EAAE;;;;6DACnC,qKAAC;wCAAe,WAAU;kDAAgC,EAAE,IAAI,CAAC,IAAI;uCAA3D,EAAE,EAAE;;;;;;2BALR,EAAE,EAAE;;;;;kCAShB,qKAAC;wBAAI,KAAK;;;;;;;;;;;;0BAGZ,qKAAC;gBAAI,WAAU;;kCACb,qKAAC;wBAAO,SAAS,IAAM,aAAa,OAAO,CAAC,KAAK;wBAAI,WAAU;kCAC7D,cAAA,qKAAC,8NAAS;;;;;;;;;;kCAEZ,qKAAC;wBAAM,MAAK;wBAAO,KAAK;wBAAc,WAAU;wBAAS,QAAQ;wBAAC,UAAU,CAAA,IAAK,YAAY,EAAE,MAAM,CAAC,KAAK;;;;;;kCAC3G,qKAAC;wBACC,OAAO;wBACP,UAAU,CAAA,IAAK,QAAQ,EAAE,MAAM,CAAC,KAAK;wBACrC,WAAU;wBACV,aAAY;;;;;;kCAEd,qKAAC;wBAAO,SAAS;wBAAa,WAAU;;0CACtC,qKAAC,+MAAI;;;;;4BAAE;;;;;;;;;;;;;;;;;;;AAKjB","debugId":null}}]
}