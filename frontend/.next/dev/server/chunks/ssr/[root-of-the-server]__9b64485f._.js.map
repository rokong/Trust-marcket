{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Nazmul/OneDrive/Documents/trust-market/frontend/pages/messages/index.js"],"sourcesContent":["//frontend/pages/messages/index.js\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter } from \"next/router\";\r\nimport axios from \"axios\";\r\n\r\nexport default function Messages() {\r\n  const router = useRouter();\r\n  const [userId, setUserId] = useState(null);\r\n  const [messages, setMessages] = useState([]);\r\n  const [input, setInput] = useState(\"\");\r\n\r\n  // Client side load হলে userId set করা\r\n  useEffect(() => {\r\n    if (typeof window !== \"undefined\") {\r\n      const id = localStorage.getItem(\"userId\");\r\n      if (!id) {\r\n        router.push(\"/login\"); // যদি লগইন না থাকে redirect\r\n      } else {\r\n        setUserId(id);\r\n      }\r\n    }\r\n  }, [router]);\r\n\r\n  const fetchMessages = async () => {\r\n    if (!userId) return;\r\n    try {\r\n      const res = await axios.get(`http://localhost:5000/api/messages/${userId}`);\r\n      setMessages(res.data);\r\n    } catch (err) {\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  const sendMessage = async () => {\r\n    if (!input || !userId) return;\r\n    try {\r\n      await axios.post(\"http://localhost:5000/api/messages/send\", {\r\n        userId,\r\n        message: input,\r\n      });\r\n      setInput(\"\");\r\n      fetchMessages();\r\n    } catch (err) {\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchMessages();\r\n  }, [userId]);\r\n\r\n  if (!userId) {\r\n    return <h2>Loading... যাচাই করা হচ্ছে লগইন</h2>;\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h2>Chat with Admin</h2>\r\n\r\n      <div style={{ border: \"1px solid gray\", height: \"400px\", overflowY: \"scroll\", padding: \"10px\" }}>\r\n        {messages.map((m) => (\r\n          <div key={m._id}><b>{m.sender}:</b> {m.message}</div>\r\n        ))}\r\n      </div>\r\n\r\n      <input\r\n        value={input}\r\n        onChange={(e) => setInput(e.target.value)}\r\n        placeholder=\"Type message...\"\r\n      />\r\n      <button onClick={sendMessage}>Send</button>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,kCAAkC;;;;;;AAClC;AACA;AACA;;;;;;;;;AAEe,SAAS;IACtB,MAAM,SAAS,IAAA,gJAAS;IACxB,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,+GAAQ,EAAC;IACrC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,+GAAQ,EAAC,EAAE;IAC3C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,+GAAQ,EAAC;IAEnC,sCAAsC;IACtC,IAAA,gHAAS,EAAC;QACR;;IAQF,GAAG;QAAC;KAAO;IAEX,MAAM,gBAAgB;QACpB,IAAI,CAAC,QAAQ;QACb,IAAI;YACF,MAAM,MAAM,MAAM,qHAAK,CAAC,GAAG,CAAC,CAAC,mCAAmC,EAAE,QAAQ;YAC1E,YAAY,IAAI,IAAI;QACtB,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC;QAChB;IACF;IAEA,MAAM,cAAc;QAClB,IAAI,CAAC,SAAS,CAAC,QAAQ;QACvB,IAAI;YACF,MAAM,qHAAK,CAAC,IAAI,CAAC,2CAA2C;gBAC1D;gBACA,SAAS;YACX;YACA,SAAS;YACT;QACF,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC;QAChB;IACF;IAEA,IAAA,gHAAS,EAAC;QACR;IACF,GAAG;QAAC;KAAO;IAEX,IAAI,CAAC,QAAQ;QACX,qBAAO,qKAAC;sBAAG;;;;;;IACb;IAEA,qBACE,qKAAC;;0BACC,qKAAC;0BAAG;;;;;;0BAEJ,qKAAC;gBAAI,OAAO;oBAAE,QAAQ;oBAAkB,QAAQ;oBAAS,WAAW;oBAAU,SAAS;gBAAO;0BAC3F,SAAS,GAAG,CAAC,CAAC,kBACb,qKAAC;;0CAAgB,qKAAC;;oCAAG,EAAE,MAAM;oCAAC;;;;;;;4BAAK;4BAAE,EAAE,OAAO;;uBAApC,EAAE,GAAG;;;;;;;;;;0BAInB,qKAAC;gBACC,OAAO;gBACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;gBACxC,aAAY;;;;;;0BAEd,qKAAC;gBAAO,SAAS;0BAAa;;;;;;;;;;;;AAGpC","debugId":null}}]
}